$(function(){function e(e){$(".box").html("").append('<h3>扫一扫，带走课程吧。订单半小时内有效哦</h3><div id="qrcode"></div>'),$("#qrcode").qrcode({render:"canvas",width:150,height:150,text:e})}var o=store.get("userInfo");if(void 0==o)alert("您还没有登录"),window.location.href="../view/login.html";else var t=o.id;void 0==t&&(alert("您还没有登录"),window.location.href="../view/login.html");var n=$.getUrlParam("coursedetailsId"),i=$.getUrlParam("courseId");console.log(t),console.log(i),$.loginStatus(o),$.logout(),function(){$.ajax({xhrFields:{withCredentials:!0},url:"http://182.92.220.222:8080/student/play?coursedetailsId="+n+"&studentId="+t,type:"get",cache:!1,processData:!1,contentType:!1,success:function(e){if("error"!=e){var o='<video id="my-video" class="video-js vjs-big-play-centered" controls preload="auto" data-setup="{}" width="990px" height="600px"><source src="'+e+'" type="video/mp4" class="videoSrc"></video>';$(".videoMain").prepend(o)}else $(".mask").fadeIn(100)},error:function(e){alert("错误！！获取不到视频地址")}})}(),function(){$(".mask").on("click",".buy",function(){$.ajax({xhrFields:{withCredentials:!0},url:"http://182.92.220.222:8080/student/tradePrecreate/?studentId="+t+"&courseId="+i,type:"get",cache:!1,processData:!1,contentType:!1,success:function(o){console.log(o),console.log(typeof o),"error"==o&&($(".box").html("").append("<p>很抱歉，购买视频失败了，请稍后再试...</p>"),window.location.href="../view/home.html"),e(o)},error:function(e){alert("错误！！")}})})}(),function(){$(".mask").on("click",".cancel",function(){window.history.back()})}()});