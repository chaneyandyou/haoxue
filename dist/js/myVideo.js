$(function(){function e(e){if("error"==e){$(".box").html("").append("<p>很抱歉，购买视频失败了，请稍后再试...</p>")}$(".box").html("").append('<h3>扫一扫，带走课程吧</h3><div id="qrcode"></div>'),$("#qrcode").qrcode({render:"canvas",width:150,height:150,text:e})}var t=store.get("userInfo");if(void 0==t)alert("您还没有登录"),window.location.href="../view/login.html";else var o=t.id;var r=$.getUrlParam("coursedetailsId"),a=$.getUrlParam("courseId");$.loginStatus(t),$.logout(),function(){$.ajax({xhrFields:{withCredentials:!0},url:"http://182.92.220.222:8080/student/play?coursedetailsId="+r+"&studentId="+o,type:"get",cache:!1,processData:!1,contentType:!1,success:function(e){if("error"!=e){var t='<video id="my-video" class="video-js vjs-big-play-centered" controls preload="auto" data-setup="{}" width="990px" height="600px"><source src="'+e+'" type="video/mp4" class="videoSrc"></video>';$(".videoMain").prepend(t)}else $(".mask").fadeIn(100)},error:function(e){alert("错误！！获取不到视频地址")}})}(),function(){$(".mask").on("click",".buy",function(){$.ajax({xhrFields:{withCredentials:!0},url:"http://182.92.220.222:8080/student/tradePrecreate/?studentId="+o+"&courseId="+a,type:"get",cache:!1,processData:!1,contentType:!1,success:function(t){console.log(t),console.log(typeof t),e(t)},error:function(e){alert("错误！！")}})})}()});